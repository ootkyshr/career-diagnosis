<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ã‚­ãƒ£ãƒªã‚¢è¨ºæ–­ãƒ„ãƒ¼ãƒ« | æ ªå¼ä¼šç¤¾ã‚³ãƒˆãƒ©</title>
    
    <!-- PWAè¨­å®š -->
    <link rel="manifest" href="manifest.json">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="ã‚­ãƒ£ãƒªã‚¢è¨ºæ–­">
    <link rel="apple-touch-icon" href="icon-192.png">
    <meta name="theme-color" content="#f5f7fa">

    <style>
        /* --- ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³å¤‰æ•°ã®å®šç¾© --- */
        :root {
            --ease-out-quint: cubic-bezier(0.23, 1, 0.32, 1);
            --ease-elastic: cubic-bezier(0.175, 0.885, 0.32, 1.275);
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        /* åŸºæœ¬ã‚¹ã‚¿ã‚¤ãƒ« */
        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Helvetica Neue', 'Hiragino Kaku Gothic ProN', Meiryo, sans-serif;
            line-height: 1.6; color: #333;
            background: #f5f7fa; /* èƒŒæ™¯ã‚’ã‚·ãƒ³ãƒ—ãƒ«ã«ï¼ˆã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³è² è·è»½æ¸›ï¼‰ */
            min-height: 100vh; padding: 20px;
            overflow-x: hidden; /* æ¨ªã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«é˜²æ­¢ */
        }
        .container { max-width: 600px; margin: 0 auto; position: relative; min-height: 100vh; }
        
        /* ãƒ˜ãƒƒãƒ€ãƒ¼ */
        header { 
            background: rgba(255,255,255,0.9); backdrop-filter: blur(10px);
            padding: 15px; margin-bottom: 20px; border-radius: 16px; 
            text-align: center; box-shadow: 0 4px 20px rgba(0,0,0,0.05);
            position: sticky; top: 10px; z-index: 100;
        }
        header img { height: 32px; object-fit: contain; }

        /* ã‚«ãƒ¼ãƒ‰ãƒ‡ã‚¶ã‚¤ãƒ³ */
        .card {
            background: #fff; border-radius: 20px; padding: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.08); margin-bottom: 30px;
            position: relative; overflow: hidden;
            transition: height 0.3s var(--ease-out-quint);
        }
        h2 { color: #003d7a; font-size: 24px; margin-bottom: 20px; text-align: center; font-weight: 800; }
        
        /* --- ãƒã‚¤ã‚¯ãƒ­ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆãƒœã‚¿ãƒ³ï¼‰ --- */
        .btn, .btn-nav, .option, .todo-item, .register-btn {
            transition: all 0.2s var(--ease-out-quint), transform 0.1s var(--ease-out-quint);
            cursor: pointer;
        }
        /* æŠ¼ã—ãŸæ™‚ã®ã€Œæ²ˆã¿è¾¼ã¿ã€æ¼”å‡º */
        .btn:active, .btn-nav:active, .option:active, .todo-item:active, .register-btn:active {
            transform: scale(0.96) !important;
            opacity: 0.9;
        }

        /* ãƒ¡ã‚¤ãƒ³ãƒœã‚¿ãƒ³ */
        .btn {
            display: block; width: 100%; padding: 18px;
            background: var(--primary-gradient);
            color: #fff; text-align: center; border-radius: 50px;
            font-size: 18px; font-weight: bold; border: none;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }
        .btn:hover { box-shadow: 0 8px 25px rgba(102, 126, 234, 0.5); transform: translateY(-2px); }

        /* ãƒªãƒ”ãƒ¼ã‚¿ãƒ¼ã‚»ã‚¯ã‚·ãƒ§ãƒ³ */
        .welcome-back-section {
            background: #f0f7ff; border: 2px solid #667eea; border-radius: 16px;
            padding: 25px; text-align: center; margin-bottom: 20px;
            animation: popIn 0.5s var(--ease-elastic);
        }
        @keyframes popIn { from { transform: scale(0.9); opacity: 0; } to { transform: scale(1); opacity: 1; } }

        .btn-secondary {
            background: #fff; color: #666; border: 2px solid #e0e0e0;
            box-shadow: none; margin-top: 15px; font-size: 15px; padding: 15px;
        }

        /* --- ç”»é¢é·ç§»ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ (Page Transitions) --- */
        .page {
            display: none; width: 100%;
            /* çµ¶å¯¾é…ç½®ã«ã—ãªã„ã¨é·ç§»æ™‚ã«å´©ã‚Œã‚‹ã“ã¨ãŒã‚ã‚‹ãŒã€é«˜ã•å¯å¤‰ã®ãŸã‚ä»Šå›ã¯JSã§åˆ¶å¾¡ */
        }
        .page.active { display: block; }

        /* å³ã‹ã‚‰å…¥ã£ã¦ãã‚‹ */
        .slide-in-right {
            animation: slideInRight 0.5s var(--ease-out-quint) forwards;
        }
        @keyframes slideInRight {
            from { opacity: 0; transform: translateX(30px) scale(0.95); }
            to { opacity: 1; transform: translateX(0) scale(1); }
        }

        /* è³ªå•ã‚«ãƒ¼ãƒ‰ã®é·ç§» */
        .question-wrapper { position: relative; }
        .question-content { transition: opacity 0.3s ease; }
        
        .fade-out-left {
            animation: fadeOutLeft 0.3s var(--ease-out-quint) forwards;
        }
        @keyframes fadeOutLeft {
            to { opacity: 0; transform: translateX(-30px); }
        }
        
        .fade-in-right {
            animation: fadeInRight 0.4s var(--ease-out-quint) forwards;
        }
        @keyframes fadeInRight {
            from { opacity: 0; transform: translateX(30px); }
            to { opacity: 1; transform: translateX(0); }
        }

        /* ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼ */
        .progress-container { margin-bottom: 30px; }
        .progress-bar { width: 100%; height: 6px; background: #eee; border-radius: 10px; overflow: hidden; margin-bottom: 8px; }
        .progress-fill { height: 100%; background: var(--primary-gradient); width: 0%; transition: width 0.6s var(--ease-out-quint); }
        
        /* é¸æŠè‚¢ */
        .option { 
            display: flex; align-items: center; padding: 16px 20px; 
            background: #f8f9fa; border: 2px solid transparent; border-radius: 12px; 
            margin-bottom: 12px;
        }
        .option.selected { 
            background: #eef2ff; border-color: #667eea; 
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.15); 
        }
        .option input { margin-right: 15px; transform: scale(1.3); accent-color: #667eea; }
        .option span { font-weight: 500; font-size: 16px; }

        /* ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ */
        .navigation-buttons { display: flex; gap: 15px; margin-top: 30px; }
        .btn-nav { 
            flex: 1; padding: 15px; background: #fff; color: #667eea; 
            border: 2px solid #667eea; border-radius: 50px; font-weight: bold; font-size: 16px;
        }
        .btn-nav:disabled { opacity: 0.3; cursor: default; transform: none !important; }
        .btn-nav:hover:not(:disabled) { background: #eef2ff; }
        #nextBtn { background: #667eea; color: #fff; }
        #nextBtn:hover { background: #5a6fd6; }

        /* çµæœç”»é¢æ¼”å‡º */
        .stagger-item { opacity: 0; transform: translateY(20px); }
        .stagger-visible { animation: fadeInUp 0.6s var(--ease-out-quint) forwards; }
        @keyframes fadeInUp { to { opacity: 1; transform: translateY(0); } }

        .result-preview { 
            text-align: center; padding: 30px 20px; 
            background: linear-gradient(180deg, #fff 0%, #fff8f0 100%); 
            border-radius: 16px; margin: 20px 0; 
            border: 2px solid #ffeeba; 
        }
        .result-type { font-size: 28px; font-weight: 800; color: #d35400; margin: 15px 0; line-height: 1.3; }

        /* ToDoãƒªã‚¹ãƒˆ */
        .todo-item {
            display: flex; align-items: flex-start; padding: 15px;
            margin-bottom: 12px; border: 1px solid #eee; border-radius: 12px;
            background-color: #fff; 
        }
        .todo-item.completed {
            background-color: #f0fdf4; border-color: #86efac;
        }
        .todo-checkbox { margin-top: 3px; margin-right: 12px; width: 20px; height: 20px; accent-color: #22c55e; }

        .todo-progress-area { padding: 20px; background: #f8fafc; border-radius: 12px; margin-bottom: 20px; }
        .todo-progress-bar-bg { height: 12px; background: #e2e8f0; border-radius: 6px; overflow: hidden; margin-top: 8px; }
        .todo-progress-bar-fill { height: 100%; background: #22c55e; width: 0%; transition: width 1s var(--ease-out-quint); }

        /* è©³ç´°ãƒ¬ãƒãƒ¼ãƒˆãªã© */
        .detail-report { display: none; margin-top: 30px; }
        .register-btn { 
            text-decoration: none; display: block; padding: 18px; margin-top: 10px;
            background: var(--primary-gradient); color: #fff; border-radius: 50px; 
            text-align: center; font-weight: bold; font-size: 16px;
        }

        footer { text-align: center; margin-top: 40px; color: #999; font-size: 12px; padding-bottom: 20px;}
    </style>
</head>
<body>
    <div class="container">
        <header>
            <img src="https://www.genspark.ai/api/files/s/iqlryruD" alt="KOTORA">
        </header>

        <!-- ã‚¹ã‚¿ãƒ¼ãƒˆç”»é¢ -->
        <div id="page-start" class="page active">
            <div class="card">
                <h2>ğŸ¯ ã‚­ãƒ£ãƒªã‚¢è¨ºæ–­</h2>
                
                <div id="welcomeSection" class="welcome-back-section" style="display:none;">
                    <p style="font-size:14px; color:#003d7a; font-weight:bold;">ãŠã‹ãˆã‚Šãªã•ã„</p>
                    <div style="font-size:13px; color:#666; margin:10px 0;">
                        å‰å›: <span id="lastDate"></span>
                    </div>
                    <div class="result-type" id="lastResultType" style="font-size:20px; margin:5px 0;"></div>
                    <button class="btn" id="resumeBtn" style="margin-top:15px;">å‰å›ã®ç¶šãã‚’è¦‹ã‚‹</button>
                    <button class="btn btn-secondary" id="restartBtn">æ–°ã—ãè¨ºæ–­ã™ã‚‹</button>
                </div>

                <div id="introSection">
                    <div style="text-align: center; margin-bottom: 30px; color: #666; font-size: 15px;">
                        <p>8ã¤ã®è³ªå•ã§ã‚ãªãŸã®å¼·ã¿ã‚’åˆ†æã€‚</p>
                        <p>å¸‚å ´ä¾¡å€¤ã‚’æœ€å¤§åŒ–ã™ã‚‹æˆ¦ç•¥ã‚’ã”ææ¡ˆã—ã¾ã™ã€‚</p>
                    </div>
                    <button class="btn" id="startBtn">è¨ºæ–­ã‚’ã¯ã˜ã‚ã‚‹</button>
                </div>
            </div>
        </div>

        <!-- è³ªå•ç”»é¢ -->
        <div id="page-questions" class="page">
            <div class="card">
                <div class="progress-container">
                    <div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div>
                    <div style="text-align: center; font-size: 12px; color: #999; font-weight:bold;" id="progressText">Q1 / 8</div>
                </div>
                
                <!-- è³ªå•ã‚«ãƒ¼ãƒ‰ï¼ˆã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ç”¨ãƒ©ãƒƒãƒ‘ãƒ¼ï¼‰ -->
                <div class="question-wrapper">
                    <div id="questionContainer" class="question-content">
                        <!-- ã“ã“ã«è³ªå•ãŒJSã§å…¥ã‚‹ -->
                    </div>
                </div>

                <div class="navigation-buttons">
                    <button class="btn-nav" id="prevBtn" disabled>æˆ»ã‚‹</button>
                    <button class="btn-nav" id="nextBtn">æ¬¡ã¸</button>
                </div>
            </div>
        </div>

        <!-- çµæœç”»é¢ -->
        <div id="page-results" class="page">
            <div class="card">
                <div id="resultContent">
                    <h2 class="stagger-item">âœ¨ è¨ºæ–­çµæœ</h2>
                    
                    <div class="result-preview stagger-item" style="animation-delay: 0.1s;">
                        <p style="color: #666; font-size:14px;">ã‚ãªãŸã®ã‚­ãƒ£ãƒªã‚¢ã‚¿ã‚¤ãƒ—</p>
                        <div class="result-type" id="resultType">...</div>
                        <p id="resultDescription" style="line-height: 1.6; color: #555; font-size:14px; margin-top: 10px;"></p>
                    </div>
                    
                    <div class="stagger-item" style="animation-delay: 0.2s; margin-top:20px;">
                        <a href="https://www.kotora.jp/service/tenshoku_entry.php?utm_source=tool&utm_medium=tool&utm_campaign=note_carrierdiagnostictool" class="register-btn" target="_blank">è©³ç´°ãªæƒ…å ±åé›†ã‚’å§‹ã‚ã‚‹</a>
                        <p style="text-align:center; font-size:12px; color:#999; margin-top:8px;">ã‚³ãƒˆãƒ©å…¬å¼ã‚µã‚¤ãƒˆã¸ç§»å‹•ã—ã¾ã™</p>
                    </div>

                    <div id="detailReport" class="detail-report">
                        <div class="stagger-item" style="animation-delay: 0.3s;">
                            <h3 style="color:#003d7a; border-bottom:2px solid #eee; padding-bottom:10px; margin-bottom:15px;">ğŸ“ˆ å¸‚å ´ä¾¡å€¤</h3>
                            <p id="marketValue" style="font-size:14px; color:#444;"></p>
                        </div>

                        <div class="stagger-item" style="animation-delay: 0.4s; margin-top:30px;">
                            <h3 style="color:#003d7a; border-bottom:2px solid #eee; padding-bottom:10px; margin-bottom:15px;">ğŸš€ ãƒã‚¯ã‚¹ãƒˆãƒ»ã‚¢ã‚¯ã‚·ãƒ§ãƒ³</h3>
                            <div class="todo-progress-area">
                                <div style="display:flex; justify-content:space-between; font-weight:bold; font-size:14px; color:#003d7a;">
                                    <span>é”æˆåº¦</span>
                                    <span id="actionPercent">0%</span>
                                </div>
                                <div class="todo-progress-bar-bg">
                                    <div id="actionBar" class="todo-progress-bar-fill"></div>
                                </div>
                            </div>
                            <div id="nextActions"></div>
                        </div>
                        
                        <div class="stagger-item" style="animation-delay: 0.5s; margin-top:30px; text-align:center;">
                            <button class="btn-nav" id="retryBtn" style="width:auto; padding:10px 30px;">ã‚¿ã‚¤ãƒˆãƒ«ã¸æˆ»ã‚‹</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <footer>
            <p>&copy; 2026 KOTORA Co., Ltd.</p>
        </footer>
    </div>

    <script>
        // --- Service Workerç™»éŒ² ---
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => navigator.serviceWorker.register('./sw.js'));
        }

        // --- ãƒ‡ãƒ¼ã‚¿å®šç¾© ---
        const questions = [
            { id: 1, text: "ç¾åœ¨ã®è·ç¨®ã«è¿‘ã„ã®ã¯ï¼Ÿ", options: [
                { text: "é‡‘è", scores: { finance: 3, analytical: 1 } },
                { text: "ä¸å‹•ç”£", scores: { realestate: 3, negotiation: 1 } },
                { text: "ã‚³ãƒ³ã‚µãƒ«ãƒ†ã‚£ãƒ³ã‚°", scores: { consulting: 3, strategy: 2 } },
                { text: "IT / DXã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢", scores: { it: 3, technical: 2 } },
                { text: "è£½é€ æ¥­", scores: { manufacturing: 3, specialist: 1 } },
                { text: "çµŒå–¶å¹¹éƒ¨ãƒ»ç®¡ç†ç³»", scores: { leadership: 3, management: 2 } },
                { text: "ãã®ä»–", scores: { versatility: 1 } }
            ]},
            { id: 2, text: "ã‚­ãƒ£ãƒªã‚¢ã§é‡è¦–ã™ã‚‹ã“ã¨ã¯ï¼Ÿ", options: [
                { text: "å°‚é–€æ€§ã‚’æ·±ã‚ã‚‹", scores: { specialist: 3, technical: 2 } },
                { text: "ãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆãƒ»çµ±ç‡", scores: { leadership: 3, management: 2 } },
                { text: "å¹…åºƒã„çµŒé¨“", scores: { generalist: 3, versatility: 2 } },
                { text: "ç¤¾ä¼šçš„ã‚¤ãƒ³ãƒ‘ã‚¯ãƒˆ", scores: { impact: 3, strategy: 2 } }
            ]},
            { id: 3, text: "ã‚„ã‚ŠãŒã„ã‚’æ„Ÿã˜ã‚‹ç¬é–“ã¯ï¼Ÿ", options: [
                { text: "é›£å•ã‚’è«–ç†çš„ã«è§£æ±º", scores: { analytical: 3, problem_solving: 2 } },
                { text: "ãƒãƒ¼ãƒ ã§æˆæœã‚’å‡ºã™", scores: { leadership: 3, teamwork: 2 } },
                { text: "æ–°ã—ã„ä»•çµ„ã¿ã‚’å‰µã‚‹", scores: { strategy: 3, innovation: 2 } },
                { text: "é¡§å®¢ã«æ„Ÿè¬ã•ã‚Œã‚‹", scores: { communication: 3, client_focus: 2 } }
            ]},
            { id: 4, text: "æœ€ã‚‚å¾—æ„ãªã‚¹ã‚­ãƒ«ã¯ï¼Ÿ", options: [
                { text: "ãƒ‡ãƒ¼ã‚¿ãƒ»å®šé‡åˆ†æ", scores: { analytical: 3, technical: 2 } },
                { text: "æˆ¦ç•¥ç«‹æ¡ˆãƒ»ä¼ç”»", scores: { strategy: 3, planning: 2 } },
                { text: "å¯¾äººæŠ˜è¡ãƒ»äº¤æ¸‰", scores: { communication: 3, negotiation: 2 } },
                { text: "ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç®¡ç†", scores: { management: 3, execution: 2 } }
            ]},
            { id: 5, text: "ç†æƒ³çš„ãªåƒãæ–¹ã¯ï¼Ÿ", options: [
                { text: "1ã¤ã®ãƒ†ãƒ¼ãƒã«æ²¡é ­", scores: { specialist: 2, focus: 2 } },
                { text: "è¤‡æ•°ã‚’åŒæ™‚é€²è¡Œ", scores: { versatility: 2, multitasking: 2 } },
                { text: "ãƒãƒ¼ãƒ ã§å”åŠ›", scores: { teamwork: 3, collaboration: 2 } },
                { text: "å€‹äººã®è£é‡ã§è‡ªç”±", scores: { autonomy: 3, independence: 2 } }
            ]},
            { id: 6, text: "è»¢è·ã§å®Ÿç¾ã—ãŸã„ã“ã¨ã¯ï¼Ÿ", options: [
                { text: "å¹´åã‚¢ãƒƒãƒ—", scores: { ambition: 2, finance: 1 } },
                { text: "æ˜‡é€²ãƒ»ã‚­ãƒ£ãƒªã‚¢ã‚¢ãƒƒãƒ—", scores: { leadership: 2, ambition: 3 } },
                { text: "æ–°ã‚¹ã‚­ãƒ«ç²å¾—", scores: { growth: 3, learning: 2 } },
                { text: "ãƒ¯ãƒ¼ã‚¯ãƒ©ã‚¤ãƒ•ãƒãƒ©ãƒ³ã‚¹", scores: { balance: 3, wellbeing: 2 } }
            ]},
            { id: 7, text: "èˆˆå‘³ã®ã‚ã‚‹ä¼æ¥­ã‚¿ã‚¤ãƒ—ã¯ï¼Ÿ", type: "checkbox", options: [
                { text: "å¤–è³‡ç³»ä¼æ¥­", scores: { global: 2, versatility: 1 } },
                { text: "æ—¥ç³»å¤§æ‰‹ä¼æ¥­", scores: { corporate: 2, stability: 1 } },
                { text: "ãƒ™ãƒ³ãƒãƒ£ãƒ¼", scores: { entrepreneurship: 2, innovation: 1 } },
                { text: "ã‚³ãƒ³ã‚µãƒ«ãƒ•ã‚¡ãƒ¼ãƒ ", scores: { consulting: 2, strategy: 1 } },
                { text: "PEãƒ•ã‚¡ãƒ³ãƒ‰ãƒ»æŠ•è³‡", scores: { finance: 2, analytical: 1 } },
                { text: "äº‹æ¥­ä¼šç¤¾ï¼ˆä¼ç”»ãƒ»DXï¼‰", scores: { management: 2, it: 1 } }
            ]},
            { id: 8, text: "5å¹´å¾Œã®ç†æƒ³åƒã¯ï¼Ÿ", options: [
                { text: "ã‚¨ã‚­ã‚¹ãƒ‘ãƒ¼ãƒˆã¨ã—ã¦èªçŸ¥", scores: { specialist: 3, expertise: 3 } },
                { text: "çµŒå–¶å±¤ã¨ã—ã¦æ´»èº", scores: { leadership: 3, management: 3 } },
                { text: "èµ·æ¥­ãƒ»ç‹¬ç«‹", scores: { entrepreneurship: 3, autonomy: 2 } },
                { text: "ã‚°ãƒ­ãƒ¼ãƒãƒ«ã«æ´»èº", scores: { global: 3, versatility: 2 } }
            ]}
        ];

        const TYPE_INFO = {
            "æˆ¦ç•¥æ€è€ƒå‹ãƒªãƒ¼ãƒ€ãƒ¼": "æˆ¦ç•¥çš„æ€è€ƒåŠ›ã¨ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—ã‚’å…¼ã­å‚™ãˆãŸã‚¿ã‚¤ãƒ—ã€‚çµ„ç¹”ã‚’ç‡ã„ã¦å¤§ããªæˆæœã‚’ç”Ÿã¿å‡ºã™ã“ã¨ãŒå¾—æ„ã§ã™ã€‚",
            "é‡‘èã‚¹ãƒšã‚·ãƒ£ãƒªã‚¹ãƒˆ": "é‡‘èçŸ¥è­˜ã¨åˆ†æåŠ›ã«å„ªã‚ŒãŸã‚¿ã‚¤ãƒ—ã€‚é«˜åº¦ãªé‡‘èå°‚é–€æ€§ãŒæ±‚ã‚ã‚‰ã‚Œã‚‹åˆ†é‡ã§æ´»èºã§ãã¾ã™ã€‚",
            "ã‚³ãƒ³ã‚µãƒ«ãƒ†ã‚£ãƒ³ã‚°ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«": "æˆ¦ç•¥ç«‹æ¡ˆã¨å•é¡Œè§£æ±ºã«é•·ã‘ãŸã‚¿ã‚¤ãƒ—ã€‚ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®çµŒå–¶èª²é¡Œã‚’è§£æ±ºã™ã‚‹ã“ã¨ã«å–œã³ã‚’æ„Ÿã˜ã¾ã™ã€‚",
            "ãƒ†ã‚¯ãƒãƒ­ã‚¸ãƒ¼ãƒ»DXãƒªãƒ¼ãƒ€ãƒ¼": "æŠ€è¡“åŠ›ã¨ã‚¤ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³å¿—å‘ã‚’æŒã¤ã‚¿ã‚¤ãƒ—ã€‚ãƒ‡ã‚¸ã‚¿ãƒ«å¤‰é©ã‚’æ¨é€²ã—ã€äº‹æ¥­æˆé•·ã«è²¢çŒ®ã§ãã¾ã™ã€‚",
            "å°‚é–€æ€§è¿½æ±‚å‹ã‚¨ã‚­ã‚¹ãƒ‘ãƒ¼ãƒˆ": "ç‰¹å®šé ˜åŸŸã®å°‚é–€æ€§ã‚’æ·±ã‚ã‚‹ã“ã¨ã«æƒ…ç†±ã‚’æŒã¤ã‚¿ã‚¤ãƒ—ã€‚ãã®é“ã®ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ã¨ã—ã¦æ´»èºã—ã¾ã™ã€‚",
            "ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå¿—å‘å‹ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«": "å„ªã‚ŒãŸã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³åŠ›ã¨æŠ˜è¡åŠ›ã‚’æŒã¤ã‚¿ã‚¤ãƒ—ã€‚ä¿¡é ¼é–¢ä¿‚ã‚’æ§‹ç¯‰ã—æœ€é©ãªææ¡ˆãŒã§ãã¾ã™ã€‚",
            "äº‹æ¥­å¤‰é©ãƒªãƒ¼ãƒ€ãƒ¼": "å¤‰é©ã‚’æ¨é€²ã™ã‚‹å®Ÿè¡ŒåŠ›ã‚’æŒã¤ã‚¿ã‚¤ãƒ—ã€‚æ–°è¦äº‹æ¥­ã‚„ãƒãƒ£ãƒ¬ãƒ³ã‚¸ãƒ£ãƒ–ãƒ«ãªç’°å¢ƒã§åŠ›ã‚’ç™ºæ®ã—ã¾ã™ã€‚",
            "ãƒãƒ«ãƒã‚¿ãƒ¬ãƒ³ãƒˆå‹ã‚¼ãƒãƒ©ãƒªã‚¹ãƒˆ": "å¹…åºƒã„çŸ¥è­˜ã¨ã‚¹ã‚­ãƒ«ã‚’æŒã¡ã€æŸ”è»Ÿã«å¯¾å¿œã§ãã‚‹ã‚¿ã‚¤ãƒ—ã€‚å¤šæ§˜ãªãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§æ¨ªæ–­çš„ã«æ´»èºã—ã¾ã™ã€‚"
        };

        const detailReports = {
            "æˆ¦ç•¥æ€è€ƒå‹ãƒªãƒ¼ãƒ€ãƒ¼": {
                marketValue: "ä¸ç¢ºå®Ÿæ€§ã®é«˜ã„ç¾ä»£ã«ãŠã„ã¦ã€ãƒ•ã‚¡ã‚¯ãƒˆã«åŸºã¥ãè«–ç†çš„ã«é€²ã‚€ã¹ãé“ã‚’ç¤ºã›ã‚‹äººæã¯å¸Œå°‘ã§ã™ã€‚ç‰¹ã«ã€Œäººã‚’å‹•ã‹ã™ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—ã€ã‚’å…¼ã­å‚™ãˆã¦ã„ã‚‹ç‚¹ã§ã€CxOå€™è£œã¨ã—ã¦ã®å¸‚å ´ä¾¡å€¤ãŒéå¸¸ã«é«˜ã„çŠ¶æ…‹ã§ã™ã€‚",
                nextActions: ["ã€Œæ„æ€æ±ºå®šã€ã®è¨€èªåŒ–ãƒ—ãƒ­ã‚»ã‚¹å…±æœ‰", "éé€£ç¶šãªæˆé•·ï¼ˆæ”¹é©ï¼‰ã®æ§‹æƒ³", "åå¯¾æ„è¦‹ã‚’æŒã¤ãƒ¡ãƒ³ãƒãƒ¼ã¨ã®1on1"]
            },
            "é‡‘èã‚¹ãƒšã‚·ãƒ£ãƒªã‚¹ãƒˆ": {
                marketValue: "æ•°å­—ã¨ã„ã†å…±é€šè¨€èªã‚’æ“ã‚Œã‚‹ã‚ãªãŸã¯ã€ã©ã®æ¥­ç•Œã§ã‚‚é‡å®ã•ã‚Œã¾ã™ã€‚ç‰¹ã«ã€ŒæŠ•è³‡å¯¾åŠ¹æœï¼ˆROIï¼‰ã€ã‚„ã€Œãƒ•ã‚¡ã‚¤ãƒŠãƒ³ã‚¹æˆ¦ç•¥ã€è¦–ç‚¹ã‚’æŒã£ã¦ã„ã‚‹å ´åˆã€PEãƒ•ã‚¡ãƒ³ãƒ‰ã‚„CFOå€™è£œã¨ã—ã¦å¼•ãæ‰‹ã‚ã¾ãŸã§ã™ã€‚",
                nextActions: ["ç¾å ´ã‚ªãƒšãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã¨å•†æµã®ç†è§£", "ã‚¨ã‚¯ã‚¤ãƒ†ã‚£ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã®æ§‹ç¯‰è¨“ç·´", "åˆ†æãƒ¬ãƒãƒ¼ãƒˆã®ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆ"]
            },
            "ã‚³ãƒ³ã‚µãƒ«ãƒ†ã‚£ãƒ³ã‚°ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«": {
                marketValue: "çŸ­æœŸé–“ã§æœ¬è³ªçš„ãªèª²é¡Œã‚’ç‰¹å®šã—ã€è§£æ±ºç­–ã‚’æç¤ºã™ã‚‹ã‚¹ã‚­ãƒ«ã¯å³æˆ¦åŠ›ã§ã™ã€‚DXã‚„ã‚µã‚¹ãƒ†ãƒŠãƒ“ãƒªãƒ†ã‚£ãªã©æ­£è§£ã®ãªã„ãƒ†ãƒ¼ãƒã«ãŠã„ã¦ã€ã‚ãªãŸã®ã‚¹ã‚­ãƒ«ã¯ç‰¹ã«è¼ãã¾ã™ã€‚",
                nextActions: ["èª²é¡Œã®ãƒ­ã‚¸ãƒƒã‚¯ãƒ„ãƒªãƒ¼åˆ†è§£", "ç¾å ´ãƒ¬ãƒ™ãƒ«ã¸ã®å®Ÿè¡Œè½ã¨ã—è¾¼ã¿", "å†æŒ‡åã•ã‚Œã‚‹é–¢ä¿‚æ§‹ç¯‰"]
            },
            "ãƒ†ã‚¯ãƒãƒ­ã‚¸ãƒ¼ãƒ»DXãƒªãƒ¼ãƒ€ãƒ¼": {
                marketValue: "ã€ŒæŠ€è¡“ã€ã¨ã€Œãƒ“ã‚¸ãƒã‚¹ï¼ˆåˆ©ç›Šï¼‰ã€ã‚’ç¿»è¨³ã§ãã‚‹äººæã¯æ¥µã‚ã¦ä¸è¶³ã—ã¦ã„ã¾ã™ã€‚çµŒå–¶å±¤ã¨ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã®å…±é€šè¨€èªã‚’æŒã¤ã‚ãªãŸã¯ã€ç¾ä»£ä¼æ¥­ã®æœ€é‡è¦äººç‰©ã§ã™ã€‚",
                nextActions: ["æŠ€è¡“æŠ•è³‡ã®PLï¼ˆæç›Šï¼‰è©¦ç®—", "æŠ€è¡“èª²é¡Œã®éã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢å‘ã‘ç¿»è¨³", "å°å…¥æ™‚ã®ãƒã‚§ãƒ³ã‚¸ãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆ"]
            },
            "å°‚é–€æ€§è¿½æ±‚å‹ã‚¨ã‚­ã‚¹ãƒ‘ãƒ¼ãƒˆ": {
                marketValue: "ã€Œã“ã®åˆ†é‡ãªã‚‰ã€‡ã€‡ã•ã‚“ã€ã¨ã„ã†ç¬¬ä¸€äººè€…ãƒã‚¸ã‚·ãƒ§ãƒ³ã¯æ™¯æ°—å¤‰å‹•ã«å¼·ãã€ç‹¬ç«‹ã‚‚å¯èƒ½ã§ã™ã€‚çŸ¥è­˜ã®æ·±ã•ãŒãã®ã¾ã¾ä»–è€…ã®å‚å…¥éšœå£ï¼ˆé˜²å¾¡åŠ›ï¼‰ã«ãªã‚Šã¾ã™ã€‚",
                nextActions: ["æœ€æ–°è«–æ–‡ãƒ»ãƒ‹ãƒ¥ãƒ¼ã‚¹ã®åé›†", "ç¤¾å¤–ç™ºä¿¡ã«ã‚ˆã‚‹ãƒ–ãƒ©ãƒ³ãƒ‰åŒ–", "å‘¨è¾ºãƒ“ã‚¸ãƒã‚¹é ˜åŸŸã¸ã®çŸ¥è­˜å¿œç”¨"]
            },
            "ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå¿—å‘å‹ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«": {
                marketValue: "AIãŒé€²åŒ–ã—ã¦ã‚‚ã€é«˜åº¦ãªã€Œäº¤æ¸‰ã€ã‚„ã€Œä¿¡é ¼æ§‹ç¯‰ã€ã¯äººé–“ã«ã—ã‹ã§ãã¾ã›ã‚“ã€‚ç„¡å½¢å•†æã‚„é«˜é¡å•†æã«ãŠã‘ã‚‹æŠ˜è¡åŠ›ã¯ã€ã©ã‚“ãªãƒ“ã‚¸ãƒã‚¹ã§ã‚‚åç›Šã®æŸ±ã§ã™ã€‚",
                nextActions: ["é¡§å®¢ä¼æ¥­ã®çµŒå–¶çŠ¶æ³æŠŠæ¡", "çœŸã®èª²é¡Œï¼ˆã‚¤ãƒ³ã‚µã‚¤ãƒˆï¼‰ã®ææ¡ˆ", "æ±ºè£è€…ã‚¯ãƒ©ã‚¹ã¨ã®å¯¾è©±"]
            },
            "äº‹æ¥­å¤‰é©ãƒªãƒ¼ãƒ€ãƒ¼": {
                marketValue: "æ–°è¦äº‹æ¥­ã‚„çµ„ç¹”æ€¥æ‹¡å¤§ãªã©ã€ã‚«ã‚ªã‚¹ãªçŠ¶æ³ã‚’æ¥½ã—ã‚ã‚‹äººæã¯è²´é‡ã§ã™ã€‚æ•´ã£ã¦ã„ãªã„ç’°å¢ƒã§è‡ªèµ°ã—é“ã‚’ä½œã‚‹åŠ›ã¯ã€ã‚¤ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³éƒ¨é–€ã§æœ€ã‚‚æ±‚ã‚ã‚‰ã‚Œã¾ã™ã€‚",
                nextActions: ["ã‚¼ãƒ­ãƒ™ãƒ¼ã‚¹ã§ã®äº‹æ¥­æ§‹æƒ³", "ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—ã«ã‚ˆã‚‹é«˜é€ŸPDCA", "æ’¤é€€ãƒ©ã‚¤ãƒ³ã®æ˜ç¢ºåŒ–"]
            },
            "ãƒãƒ«ãƒã‚¿ãƒ¬ãƒ³ãƒˆå‹ã‚¼ãƒãƒ©ãƒªã‚¹ãƒˆ": {
                marketValue: "å¤‰åŒ–ã®æ¿€ã—ã„ç¾ä»£ã§ã¯ã€Œå…¨ä½“æœ€é©åŒ–ã®ãƒ—ãƒ­ã€ã¨ã—ã¦å†è©•ä¾¡ã•ã‚Œã¦ã„ã¾ã™ã€‚éƒ¨é–€é–“ã®å£ã‚’å–ã‚Šæ‰•ã„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’é€²ã‚ã‚‹åŠ›ã¯ã€COOã‚„ç¤¾é•·å®¤é•·ã¨ã—ã¦é‡è¦ã§ã™ã€‚",
                nextActions: ["çµ„ç¹”é–“ã®ã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³å¯è¦–åŒ–", "PMæ‰‹æ³•ã®ä½“ç³»åŒ–ï¼ˆè„±å±äººåŒ–ï¼‰", "éƒ¨ç½²é–“ã®ç¿»è¨³è€…ãƒã‚¸ã‚·ãƒ§ãƒ³ç¢ºç«‹"]
            }
        };

        const STORAGE_KEY = 'kotora_career_v3';
        let currentQuestion = 0;
        let answers = {};

        // --- åˆæœŸåŒ– ---
        document.addEventListener('DOMContentLoaded', () => {
            initStorageCheck();
            
            // ã‚¿ãƒƒãƒ—é…å»¶è§£æ¶ˆ
            document.body.addEventListener('touchstart', function() {}, {passive: true});

            document.getElementById('startBtn').addEventListener('click', () => switchPage('page-start', 'page-questions'));
            document.getElementById('restartBtn').addEventListener('click', () => switchPage('page-start', 'page-questions'));
            document.getElementById('resumeBtn').addEventListener('click', restorePreviousResult);
            
            document.getElementById('prevBtn').addEventListener('click', prevQuestion);
            document.getElementById('nextBtn').addEventListener('click', nextQuestion);
            document.getElementById('retryBtn').addEventListener('click', () => location.reload());

            showQuestion(0, 'init');
        });

        // --- ç”»é¢é·ç§»ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³é–¢æ•° ---
        function switchPage(fromId, toId) {
            const fromPage = document.getElementById(fromId);
            const toPage = document.getElementById(toId);

            // ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ä½ç½®ãƒªã‚»ãƒƒãƒˆ
            window.scrollTo(0, 0);

            toPage.classList.add('active', 'slide-in-right');
            
            // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³çµ‚äº†å¾Œã«ã‚¯ãƒ©ã‚¹æ•´ç†
            setTimeout(() => {
                fromPage.classList.remove('active');
                toPage.classList.remove('slide-in-right');
            }, 500);
        }

        // --- ãƒ‡ãƒ¼ã‚¿ç®¡ç† ---
        function getStorageData() {
            try { return JSON.parse(localStorage.getItem(STORAGE_KEY)) || { latest: null, actions: {} }; }
            catch { return { latest: null, actions: {} }; }
        }
        function saveStorageData(data) { localStorage.setItem(STORAGE_KEY, JSON.stringify(data)); }

        function initStorageCheck() {
            const data = getStorageData();
            if (data.latest && data.latest.type) {
                document.getElementById('welcomeSection').style.display = 'block';
                document.getElementById('introSection').style.display = 'none';
                document.getElementById('lastResultType').textContent = data.latest.type;
                const d = new Date(data.latest.date);
                document.getElementById('lastDate').textContent = `${d.getMonth()+1}/${d.getDate()} ${d.getHours()}:${String(d.getMinutes()).padStart(2,'0')}`;
            }
        }

        // --- è³ªå•è¡¨ç¤ºãƒ­ã‚¸ãƒƒã‚¯ï¼ˆã‚¹ãƒ¯ã‚¤ãƒ—é¢¨ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ä»˜ãï¼‰ ---
        function showQuestion(index, mode = 'next') {
            const container = document.getElementById('questionContainer');
            const q = questions[index];
            const inputType = q.type === 'checkbox' ? 'checkbox' : 'radio';
            
            // æ–°ã—ã„HTMLã‚’ç”Ÿæˆ
            let html = `<div class="question-title" style="font-size:20px; font-weight:bold; margin-bottom:15px;">Q${index + 1}. ${q.text}</div>`;
            if (inputType === 'checkbox') html += `<div style="font-size:12px; color:#667eea; margin-bottom:15px;">âœ“ è¤‡æ•°é¸æŠå¯</div>`;
            
            q.options.forEach((option, i) => {
                const isChecked = checkIfSelected(q.id, i, inputType);
                html += `
                    <div class="option ${isChecked ? 'selected' : ''}" onclick="handleOptionClick(this, ${index}, ${i}, '${inputType}')">
                        <input type="${inputType}" ${isChecked ? 'checked' : ''} readonly>
                        <span>${option.text}</span>
                    </div>`;
            });

            // åˆå›è¡¨ç¤ºãªã‚‰ãã®ã¾ã¾æç”»
            if (mode === 'init') {
                container.innerHTML = html;
            } else {
                // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³åˆ‡ã‚Šæ›¿ãˆ
                container.classList.add('fade-out-left');
                
                setTimeout(() => {
                    container.innerHTML = html;
                    container.classList.remove('fade-out-left');
                    container.classList.add('fade-in-right');
                    
                    setTimeout(() => {
                        container.classList.remove('fade-in-right');
                    }, 400);
                }, 300);
            }

            // ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼æ›´æ–°
            const progress = ((index + 1) / questions.length) * 100;
            document.getElementById('progressFill').style.width = `${progress}%`;
            document.getElementById('progressText').textContent = `Q ${index + 1} / ${questions.length}`;
            
            document.getElementById('prevBtn').disabled = index === 0;
            document.getElementById('nextBtn').textContent = index === questions.length - 1 ? 'è¨ºæ–­çµæœã‚’è¦‹ã‚‹' : 'æ¬¡ã¸';
            
            // ãƒšãƒ¼ã‚¸ä¸Šéƒ¨ã¸ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ï¼ˆãƒ¢ãƒã‚¤ãƒ«ç”¨ï¼‰
            // container.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        function checkIfSelected(qId, optIndex, inputType) {
            if (!answers[qId]) return false;
            if (inputType === 'checkbox') return answers[qId].includes(optIndex);
            return answers[qId] === optIndex;
        }

        // ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¹ã‚³ãƒ¼ãƒ—ã«é–¢æ•°å…¬é–‹ï¼ˆHTMLã®onclickç”¨ï¼‰
        window.handleOptionClick = function(el, qIndex, optIndex, inputType) {
            const q = questions[qIndex];
            const checkbox = el.querySelector('input');
            
            if (inputType === 'checkbox') {
                if (!answers[q.id]) answers[q.id] = [];
                const idx = answers[q.id].indexOf(optIndex);
                if (idx > -1) {
                    answers[q.id].splice(idx, 1);
                    checkbox.checked = false;
                    el.classList.remove('selected');
                } else {
                    answers[q.id].push(optIndex);
                    checkbox.checked = true;
                    el.classList.add('selected');
                }
            } else {
                answers[q.id] = optIndex;
                // ä»–ã®é¸æŠã‚’è§£é™¤
                const allOpts = el.parentElement.querySelectorAll('.option');
                allOpts.forEach(o => {
                    o.classList.remove('selected');
                    o.querySelector('input').checked = false;
                });
                // è‡ªåˆ†ã‚’é¸æŠ
                checkbox.checked = true;
                el.classList.add('selected');

                // ã‚·ãƒ³ã‚°ãƒ«é¸æŠã®å ´åˆã¯è‡ªå‹•ã§æ¬¡ã¸é€²ã‚€æ¼”å‡ºã‚’å…¥ã‚Œã¦ã‚‚è‰¯ã„ãŒã€
                // èª¤ã‚¿ãƒƒãƒ—é˜²æ­¢ã®ãŸã‚ä»Šå›ã¯ãƒœã‚¿ãƒ³é·ç§»ã®ã¾ã¾ã«ã™ã‚‹
            }
        };

        function prevQuestion() {
            if (currentQuestion > 0) {
                currentQuestion--;
                showQuestion(currentQuestion, 'prev');
            }
        }

        function nextQuestion() {
            const q = questions[currentQuestion];
            if (!validateAnswer(q)) {
                // æºã‚Œã‚‹ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãªã©ã§è­¦å‘Šã—ã¦ã‚‚è‰¯ã„
                alert('é¸æŠè‚¢ã‚’é¸ã‚“ã§ãã ã•ã„');
                return;
            }
            if (currentQuestion < questions.length - 1) {
                currentQuestion++;
                showQuestion(currentQuestion, 'next');
            } else {
                calculateAndShowResult();
            }
        }

        function validateAnswer(q) {
            if (q.type === 'checkbox') return answers[q.id] && answers[q.id].length > 0;
            return answers[q.id] !== undefined;
        }

        function calculateAndShowResult() {
            let scores = {};
            questions.forEach(q => {
                const ans = answers[q.id];
                if (ans === undefined) return;
                const selected = Array.isArray(ans) ? ans : [ans];
                selected.forEach(idx => {
                    const sc = q.options[idx].scores;
                    for (const k in sc) scores[k] = (scores[k] || 0) + sc[k];
                });
            });

            // åˆ¤å®šãƒ­ã‚¸ãƒƒã‚¯
            const get = k => scores[k] || 0;
            let type = "ãƒãƒ«ãƒã‚¿ãƒ¬ãƒ³ãƒˆå‹ã‚¼ãƒãƒ©ãƒªã‚¹ãƒˆ";
            if (get('leadership') + get('strategy') + get('management') >= 13) type = "æˆ¦ç•¥æ€è€ƒå‹ãƒªãƒ¼ãƒ€ãƒ¼";
            else if (get('finance') + get('analytical') >= 7) type = "é‡‘èã‚¹ãƒšã‚·ãƒ£ãƒªã‚¹ãƒˆ";
            else if (get('consulting') + get('strategy') >= 8) type = "ã‚³ãƒ³ã‚µãƒ«ãƒ†ã‚£ãƒ³ã‚°ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«";
            else if (get('it') + get('innovation') >= 7) type = "ãƒ†ã‚¯ãƒãƒ­ã‚¸ãƒ¼ãƒ»DXãƒªãƒ¼ãƒ€ãƒ¼";
            else if (get('specialist') >= 8) type = "å°‚é–€æ€§è¿½æ±‚å‹ã‚¨ã‚­ã‚¹ãƒ‘ãƒ¼ãƒˆ";
            else if (get('communication') + get('negotiation') >= 8) type = "ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå¿—å‘å‹ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«";
            else if ((get('leadership') + get('versatility') >= 9) || (get('entrepreneurship') >= 5)) type = "äº‹æ¥­å¤‰é©ãƒªãƒ¼ãƒ€ãƒ¼";

            // ä¿å­˜
            const data = getStorageData();
            data.latest = { type: type, date: new Date().getTime() };
            saveStorageData(data);

            // è¡¨ç¤º
            document.getElementById('resultType').textContent = type;
            document.getElementById('resultDescription').textContent = TYPE_INFO[type];
            displayDetailReport(type);
            
            switchPage('page-questions', 'page-results');
            
            // çµæœç”»é¢ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ç™ºç«
            triggerResultAnimations();
        }

        function restorePreviousResult() {
            const data = getStorageData();
            if (data.latest && data.latest.type) {
                const type = data.latest.type;
                document.getElementById('resultType').textContent = type;
                document.getElementById('resultDescription').textContent = TYPE_INFO[type];
                displayDetailReport(type);
                switchPage('page-start', 'page-results');
                triggerResultAnimations();
            }
        }

        function triggerResultAnimations() {
            // Staggerã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ç”¨ã®ã‚¯ãƒ©ã‚¹ä»˜ä¸
            const items = document.querySelectorAll('.stagger-item');
            items.forEach(item => {
                item.classList.remove('stagger-visible');
                void item.offsetWidth; // ãƒªãƒ•ãƒ­ãƒ¼
                item.classList.add('stagger-visible');
            });
        }

        function displayDetailReport(type) {
            const data = detailReports[type];
            if (!data) return;

            document.getElementById('detailReport').style.display = 'block';
            document.getElementById('marketValue').textContent = data.marketValue;

            // ToDoç”Ÿæˆ
            const list = document.getElementById('nextActions');
            list.innerHTML = '';
            const stored = getStorageData();
            const checks = stored.actions[type] || [];

            data.nextActions.forEach((txt, i) => {
                const div = document.createElement('div');
                const isDone = !!checks[i];
                div.className = `todo-item ${isDone ? 'completed' : ''}`;
                div.innerHTML = `<input type="checkbox" class="todo-checkbox" ${isDone ? 'checked' : ''}><span>${txt}</span>`;
                
                div.addEventListener('click', function(e) {
                    if (e.target.tagName !== 'INPUT') {
                        const cb = this.querySelector('input');
                        cb.checked = !cb.checked;
                    }
                    const cb = this.querySelector('input');
                    if(cb.checked) this.classList.add('completed');
                    else this.classList.remove('completed');
                    
                    saveActionState(type, i, cb.checked);
                    updateProgress(type, data.nextActions.length);
                });
                list.appendChild(div);
            });
            updateProgress(type, data.nextActions.length);
        }

        function saveActionState(type, idx, val) {
            const d = getStorageData();
            if (!d.actions[type]) d.actions[type] = [];
            d.actions[type][idx] = val;
            saveStorageData(d);
        }

        function updateProgress(type, total) {
            const d = getStorageData();
            const c = d.actions[type] || [];
            const count = c.filter(Boolean).length;
            const pct = Math.round((count / total) * 100);
            document.getElementById('actionPercent').textContent = `${pct}%`;
            document.getElementById('actionBar').style.width = `${pct}%`;
        }
    </script>
</body>
</html>